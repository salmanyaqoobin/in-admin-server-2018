{"version":3,"sources":["server/coupon/coupon.model.js"],"names":["async","require","Promise","mongoose","httpStatus","APIError","validator","_","ObjectID","CouponScheme","Schema","title","type","String","trim","minlength","required","start_date","Date","default","now","end_date","coupon_type","enum","total_coupon_limit","Number","total_coupon_consumed","region","createdAt","couponQR","qr_id","Types","ObjectId","qrStatus","min","max","coupon_prizes","prize_id","prize_name","prize_image","prize_value","coupon_status","method","toJSON","coupon","couponObject","toObject","generateQR","total_qr","i","push","save","then","removeQR","update","$pull","multi","catch","e","reject","countQR","aggregatorOpts","$unwind","$group","count","$sum","aggregate","exec","statics","get","id","findById","err","NOT_FOUND","list","skip","limit","find","select","sort","Coupon","model","module","exports"],"mappings":"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","file":"coupon.model.js","sourceRoot":"../../../../.."}